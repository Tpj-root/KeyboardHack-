from PIL import Image, ImageDraw, ImageFont, ImageOps

def create_png_with_text(output_path, text, font_path=None, font_size=50, image_size=(500, 200), text_color=(0, 0, 0), bg_color=(255, 255, 255), corner_radius=20):
    # Create a blank image with the specified background color
    img = Image.new('RGB', image_size, bg_color)
    
    # Initialize ImageDraw
    draw = ImageDraw.Draw(img)
    
    # Load font if provided, else use default
    font = ImageFont.truetype(font_path, font_size) if font_path else ImageFont.load_default()
    
    # Create rounded corners manually
    mask = Image.new("L", image_size, 0)
    mask_draw = ImageDraw.Draw(mask)
    
    # Draw rounded corners
    width, height = image_size
    mask_draw.rectangle([corner_radius, 0, width - corner_radius, height], fill=255)
    mask_draw.rectangle([0, corner_radius, width, height - corner_radius], fill=255)
    mask_draw.pieslice([0, 0, corner_radius * 2, corner_radius * 2], 180, 270, fill=255)
    mask_draw.pieslice([width - corner_radius * 2, 0, width, corner_radius * 2], 270, 360, fill=255)
    mask_draw.pieslice([0, height - corner_radius * 2, corner_radius * 2, height], 90, 180, fill=255)
    mask_draw.pieslice([width - corner_radius * 2, height - corner_radius * 2, width, height], 0, 90, fill=255)

    # Split text into lines
    lines = text.split('\n')
    line_height = font_size + 5  # Add spacing between lines
    total_text_height = line_height * len(lines)
    
    # Start drawing from the vertical center
    y_offset = (image_size[1] - total_text_height) // 2
    
    for line in lines:
        text_width, _ = draw.textsize(line, font=font)
        x_offset = (image_size[0] - text_width) // 2
        draw.text((x_offset, y_offset), line, fill=text_color, font=font)
        y_offset += line_height

    # Apply the mask to the image
    rounded_img = ImageOps.fit(img, image_size, centering=(0.5, 0.5))
    rounded_img.putalpha(mask)
    
    # Save as PNG
    rounded_img.save(output_path, format="PNG")
    print(f"Image saved at {output_path}")


if __name__ == "__main__":
    # Example inputs (these can be modified as needed)
    inputs = {
        "001": ["Esc", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "001.png"],
        "002": ["F1", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "002.png"],
        "003": ["F2", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "003.png"],
        "004": ["F3", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "004.png"],
        "005": ["F4", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "005.png"],
        "006": ["F5", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "006.png"],
        "007": ["F6", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "007.png"],
        "008": ["F7", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "008.png"],
        "009": ["F8", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "009.png"],
        "010": ["F9", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "010.png"],
        "011": ["F10", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "011.png"],
        "012": ["F11", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "012.png"],
        "013": ["F12", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "013.png"],
        "014": ["Print\nScreen", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "014.png"],
        "015": ["Scroll\nLock", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "015.png"],
        "016": ["Pause\nBreak", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "016.png"],
        "017": ["Tilde", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "017.png"],
        "018": ["1", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "018.png"],
        "019": ["2", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "019.png"],
        "020": ["3", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "020.png"],
        "021": ["4", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "021.png"],
        "022": ["5", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "022.png"],
        "023": ["6", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "023.png"],
        "024": ["7", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "024.png"],
        "025": ["8", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "025.png"],
        "026": ["9", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "026.png"],
        "027": ["0", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "027.png"],
        "028": [" _ \n -", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "028.png"],
        "029": [" + \n =", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "029.png"],
        "030": [" | \n \\", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "030.png"],
        "031": ["Back\nspace", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "031.png"],
        "032": ["Insert", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "032.png"],
        "033": ["Home", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "033.png"],
        "034": ["Page\nUp", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "034.png"],
        "035": ["Num\nLock", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "035.png"],
        "036": ["/", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "036.png"],
        "037": ["*", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "037.png"],
        "038": ["-", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "038.png"],
        "039": ["Tab", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "039.png"],
        "040": ["Q", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "040.png"],
        "041": ["W", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "041.png"],
        "042": ["E", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "042.png"],
        "043": ["R", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "043.png"],
        "044": ["T", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "044.png"],
        "045": ["Y", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "045.png"],
        "046": ["U", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "046.png"],
        "047": ["I", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "047.png"],
        "048": ["O", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "048.png"],
        "049": ["P", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "049.png"],
        "050": [" { \n [ ", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "050.png"],
        "051": [" } \n ] ", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "051.png"],
        "052": ["Enter", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "052.png"],
        "053": ["Delete", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "053.png"],
        "054": ["End", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "054.png"],
        "055": ["Page\nDown", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "055.png"],
        "056": ["7", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "056.png"],
        "057": ["8", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "057.png"],
        "058": ["9", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "058.png"],
        "059": ["+", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "059.png"],
        "060": ["CapsLock", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "060.png"],
        "061": ["A", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "061.png"],
        "062": ["S", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "062.png"],
        "063": ["D", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "063.png"],
        "064": ["F", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "064.png"],
        "065": ["G", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "065.png"],
        "066": ["H", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "066.png"],
        "067": ["J", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "067.png"],
        "068": ["K", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "068.png"],
        "069": ["L", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "069.png"],
        "070": [" : \n ; ", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "070.png"],
        "071": [' " \n  ', (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "071.png"],
        "072": ["4", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "072.png"],
        "073": ["5", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "073.png"],
        "074": ["6", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "074.png"],
        "075": ["Shift_L", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "075.png"],
        "076": ["Z", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "076.png"],
        "077": ["X", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "077.png"],
        "078": ["C", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "078.png"],
        "079": ["V", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "079.png"],
        "080": ["B", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "080.png"],
        "081": ["N", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "081.png"],
        "082": ["M", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "082.png"],
        "083": ["< \n , ", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "083.png"],
        "084": ["> \n . ", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "084.png"],
        "085": ["? \n / ", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "085.png"],
        "086": ["Shift_R", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "086.png"],
        "087": ["UP", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "087.png"],
        "088": ["1", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "088.png"],
        "089": ["2", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "089.png"],
        "090": ["3", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "090.png"],
        "091": ["Enter", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "091.png"],
        "092": ["Ctrl_L", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "092.png"],
        "093": ["Win", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "093.png"],
        "094": ["Alt_L", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "094.png"],
        "095": ["Spacebar", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "095.png"],
        "096": ["Alt_R", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "096.png"],
        "097": ["Win", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "097.png"],
        "098": ["Box", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "098.png"],
        "099": ["Ctrl_R", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "099.png"],
        "100": ["LEFT", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "100.png"],
        "101": ["DOWN", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "101.png"],
        "102": ["RIGHT", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "102.png"],
        "103": [" 0 \n Ins", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "103.png"],
        "104": [" . \n Del", (200, 200), (255, 192, 203), 50, (0, 0, 0), 30, "104.png"]

    }
    
    font_path = "/usr/share/fonts/truetype/dejavu/DejaVuSans-Bold.ttf"  # Adjust path if needed

    for key, values in inputs.items():
        text, image_size, bg_color, font_size, text_color, corner_radius, output_file = values
        create_png_with_text(output_file, text, font_path, font_size, image_size, text_color, bg_color, corner_radius)

